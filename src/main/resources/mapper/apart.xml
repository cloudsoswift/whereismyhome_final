<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.home.apart.model.mapper.ApartMapper">

	<select id="searchApart" parameterType="Map" resultType="HouseDTO">
		select i.aptCode, i.apartmentName, max(d.dealAmount) dealAmount,
		i.roadName, i.lng,
		i.lat, d.area, d.floor,
		concat(d.dealYear,'.', d.dealMonth,'.', d.dealDay) date, d.no
		from houseinfo i join housedeal d
		on i.aptCode = d.aptCode
		where i.dongCode = #{code}
		group by aptCode;
	</select>

	<select id="searchDeal" parameterType="Map" resultType="Map">
		select DISTINCT d.dealAmount,
		concat(d.dealYear,'.', d.dealMonth,'.', d.dealDay) date
		from housedeal d
		where d.aptCode = #{aptCode} and d.area = #{area}
	</select>

	<insert id="addInterestApart" parameterType="HouseLikeDTO">
		insert into
		houselike (user_id, no, register_time, ip_address)
		values(#{user_id},
		#{no}, now(), #{ip_address})
	</insert>

	<delete id="deleteInterestApart" parameterType="Map">
		delete from
		houselike
		where user_id = #{user_id} and no = #{no}
	</delete>

</mapper>